# doing

# to do
- separate vulkan functions (ex. into VkImgui & VkViewport)
- FIX: plane move could be more efficient, now is computing homography matrix on single marker move. when moving a plane, all 4 markers gets moved one at a time

# missing features
- draw screen area to viewport
- viewport panning/zooming
- input area for each plane
- scenes
- timelines

# done
- [x] FIX: sampled frame seems too bright
- [x] video decode
	- notes:
		- [wicked engine blog](https://wickedengine.net/2023/05/07/vulkan-video-decoding/)
		- dynamic load extensions functions
			- [reddit comment](https://www.reddit.com/r/vulkan/comments/jeolie/linker_error_using/)
			- (alternative) [volk](https://github.com/zeux/volk)
			- using volk
		- terminology:
			- gop: group of pictures, streak of related decoded frames generated from a single intra frame at the start
			- dpb: decoded picture buffer, the buffer of the **currently** active reference frames (predictive or intra)
	- to do:
		- [x] load video stream
		- [x] init decode
		- [x] create textures
			- [x] fix image view, see wickedengine's implementation
		- [x] ycbcr sampler
			- [maister's graphics adventures blog](https://themaister.net/blog/2019/12/01/yuv-sampling-in-vulkan-a-niche-and-complicated-feature-vk_khr_ycbcr_sampler_conversion/) 
			- as is, if you want to show video frames through imgui, need to refactor imgui's `ImGui_ImplVulkan_CreateDeviceObjects` by adding pImmutableSampler data (maybe through imgui's initInfo)
			- [x] working sampler
		- [x] decode a frame
		- [x] video on plane
		- [x] dpb
		- [x] smooth video playing & synchronization
			- [x] rendering image view should be updated only after decode operation (validator error)
			- [x] FIX: every loop, the image view gets updated since `decodeFrame` returns the current image view from the dpb every time
		- [x] multiple video
- [x] fullscreen projection window
	- [x] implementation
	- [x] FIXME: closing app with projection window open causes validation error
	- [x] FIXME: video frames
		- ?single renderer function
			- different renderpasses (imgui, viewport, output)
		- [x] refactor loadpipelines
		- [x] remove shared state struct
- [x] media selection like resolume arena:
	- 2 buttons, one for plane, one for media selection
- [x] media remove
- [x] cmake migration
- [x] draw imgui
	- following [this guide](https://frguthmann.github.io/posts/vulkan_imgui/)
- [x] add the main scene as a vulkan viewport inside ImGui
	- [x] refactor to present only imgui
	- [x] render the scene into an image view using framebuffers (offscreen rendering)
		- [x] To check: as many multiple frames in flight
			- the command buffer follows the same principle (may not be correct for imageviews/framebuffers?)
		- useful links:
			- [github repo](https://github.com/SaschaWillems/Vulkan/blob/master/examples/offscreen/offscreen.cpp)
	- [x] use the result in imgui as a texture
		- Useful links:
			- [github issue](https://github.com/ocornut/imgui/issues/5110)
	- [x] pass correct mouse position to scene
		- rendering viewport during imgui rendering but before adding image
	- [x] cleanup
- [x] draw line around planes
	- [x] CHECKME: vertex/index buffer passed to pipeline
- [x] media manager
	- plane-to-media binding
		- multiple media could be used by multiple planes in multiple scenes
	- [x] load files (images)
	- [x] show files in list
	- [x] with a plane selected, bind a image to the plane
		- [x] highlight binded image
